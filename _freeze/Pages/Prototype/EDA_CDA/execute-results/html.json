{
  "hash": "b0ba52c00aa8659124fe9b5b62faf75d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploratory Data Analysis and Confirmatory Data Analysis\"\ntitle-block-banner: true\nauthor: \"WANG XINGYUN\"\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n# 1.Setup\n\n## 1.1 Loading Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, lubridate, SmartEDA, \n               ggplot2, DataExplorer, dplyr, ggmap,\n               ggstatsplot, ggpubr)\n```\n:::\n\n\n\n## 1.2 Loading Data\n\nDue to the download method of the Singapore Meteorological Agency website, the relevant data for each location can only be downloaded on a monthly basis. However, our project requires downloading 86 files for 62 locations from 2018 to 2024, which means that one location needs to download 86 files. After Python processing, we merged them into one CSV file and named it weather_data\n\nWe will load the merged raw data weather_data.csv and the currently active station data (active_rainfall_stations.csv)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather <- read.csv(\"data/weather_data.csv\")\nactive_stations <- read.csv(\"data/active_rainfall_stations.csv\")\n```\n:::\n\n\n\n# 2. Cleaning Data and Descriptive analysis\n\nWe have to filter for active stationâ€“total 27 stations for next analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove () for consistent naming\nweather$Station <- gsub(\"[()]\", \"\", trimws(as.character(weather$Station)))\nactive_stations$Station.Name <- gsub(\"[()]\", \"\", trimws(as.character(active_stations$Station.Name)))\n\n# Filter for active stations\nweather_active <- weather %>% \n  filter(Station %in% active_stations$Station.Name)\n\n# Select relevant columns for EDA \nweather_active <- weather_active %>%\n  select(\n    Station, Year, Month, Day,\n    Daily.Rainfall.Total..mm.,\n    Highest.30.Min.Rainfall..mm.,\n    Highest.60.Min.Rainfall..mm.,\n    Highest.120.Min.Rainfall..mm.,\n  ) %>%\n  filter(!is.na(Daily.Rainfall.Total..mm.)) %>%\n  merge(active_stations, by.x = \"Station\", by.y = \"Station.Name\") %>%\n  select(\n    Station, Year, Month, Day,\n    Daily.Rainfall.Total..mm.,\n    Highest.30.Min.Rainfall..mm.,\n    Highest.60.Min.Rainfall..mm.,\n    Highest.120.Min.Rainfall..mm.,\n    Latitude, Longitude\n  ) %>%\n  mutate(\n    Date = make_date(Year, Month, Day),\n    Station = as.factor(Station),\n    \n    # Add Monsoon Season Label\n    Season = case_when(\n      Month %in% c(12, 1, 2) | (Month == 3 & Day <= 15) ~ \"Northeast Monsoon\",\n      (Month == 3 & Day > 15) | Month %in% c(4, 5) ~ \"Inter-monsoon I\",\n      Month %in% c(6, 7, 8, 9) ~ \"Southwest Monsoon\",\n      Month %in% c(10, 11) ~ \"Inter-monsoon II\",\n      TRUE ~ \"Unknown\"\n    ),\n    Season = factor(Season, levels = c(\"Northeast Monsoon\", \"Inter-monsoon I\", \"Southwest Monsoon\", \"Inter-monsoon II\"))\n  ) %>%\n  arrange(Station, Date)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# all variables EDA (descriptive statistical)\nweather_active %>% ExpData(type = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                          Descriptions   Value\n1                                   Sample size (nrow)   64853\n2                              No. of variables (ncol)      12\n3                    No. of numeric/interger variables       9\n4                              No. of factor variables       2\n5                                No. of text variables       0\n6                             No. of logical variables       0\n7                          No. of identifier variables       0\n8                                No. of date variables       1\n9             No. of zero variance variables (uniform)       0\n10               %. of variables having complete cases 75% (9)\n11   %. of variables having >0% and <50% missing cases 25% (3)\n12 %. of variables having >=50% and <90% missing cases  0% (0)\n13          %. of variables having >=90% missing cases  0% (0)\n```\n\n\n:::\n\n```{.r .cell-code}\nweather_active %>% ExpData(type = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Index                 Variable_Name Variable_Type Sample_n Missing_Count\n1      1                       Station        factor    64853             0\n2      2                          Year       numeric    64853             0\n3      3                         Month       numeric    64853             0\n4      4                           Day       numeric    64853             0\n5      5     Daily.Rainfall.Total..mm.       numeric    64853             0\n6      6  Highest.30.Min.Rainfall..mm.       numeric    64506           347\n7      7  Highest.60.Min.Rainfall..mm.       numeric    64485           368\n8      8 Highest.120.Min.Rainfall..mm.       numeric    64485           368\n9      9                      Latitude       numeric    64853             0\n10    10                     Longitude       numeric    64853             0\n11    11                          Date          Date    64853             0\n12    12                        Season        factor    64853             0\n   Per_of_Missing No_of_distinct_values\n1           0.000                    27\n2           0.000                     7\n3           0.000                    12\n4           0.000                    31\n5           0.000                   679\n6           0.005                   346\n7           0.006                   450\n8           0.006                   542\n9           0.000                    27\n10          0.000                    27\n11          0.000                  2557\n12          0.000                     4\n```\n\n\n:::\n:::\n\n\n\nWe filtered historical weather data from active MSS rainfall stations and retained relevant columns for temporal rainfall analysis, including daily and extreme rainfall. We added a 'Date' column and labeled each record with a monsoon season based on the calendar month. Missing values in 'Daily Rainfall' were removed for analysis consistency.\n\n# 3. Exploratory Data Analysis\n\n## 3.1 Monthly trends\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>%\n  group_by(Year, Month) %>%\n  summarise(AvgRain = mean(Daily.Rainfall.Total..mm., na.rm = TRUE)) %>%\n  ggplot(aes(x = Month, y = AvgRain, group = Year, color = as.factor(Year))) +\n  geom_line() + geom_point() +\n  labs(title = \"Monthly Average Rainfall\", y = \"Avg Rainfall (mm)\", color = \"Year\") +\n  scale_x_continuous(breaks = 1:12) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## 3.2 Comparison of Rainfall in Various Monsoon Seasons\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# the rainfall in all seasons \nlibrary(ggplot2)\nggplot(weather_active, aes(x = Season, y = Daily.Rainfall.Total..mm.)) +\n  geom_boxplot(fill = \"skyblue\") +\n  theme_minimal() +\n  labs(title = \"Daily Rainfall across Monsoon Seasons\", y = \"Daily Rainfall (mm)\")\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## 3.3 Seasonal distribution - average monthly rainfall\n\nCheck which months have the highest rainfall throughout the year and whether it is consistent with the monsoon cycle\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>%\n  group_by(Month) %>%\n  summarise(Avg_Rain = mean(Daily.Rainfall.Total..mm.)) %>%\n  ggplot(aes(x = Month, y = Avg_Rain)) +\n  geom_col(fill = \"steelblue\") +\n  labs(title = \"Average Daily Rainfall by Month\", x = \"Month\", y = \"Avg Daily Rainfall (mm)\") +\n  scale_x_continuous(breaks = 1:12) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## 3.4 Annual trend - total annual rainfall\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>%\n  group_by(Year) %>%\n  summarise(Total_Rainfall = sum(Daily.Rainfall.Total..mm.)) %>%\n  ggplot(aes(x = Year, y = Total_Rainfall)) +\n  geom_line(group = 1, color = \"lightblue\", size = 1.2) +\n  geom_point(color = \"lightgreen\") +\n  labs(title = \"Total Rainfall by Year\", y = \"Total Rainfall (mm)\") +\n  scale_x_continuous(breaks = 2018:2024) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## 3.5 Rainfall differences at different sites\n\nCheck which region has the most rainfall and whether there is any geographical deviation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>%\n  group_by(Station) %>%\n  summarise(Avg_Rain = mean(Daily.Rainfall.Total..mm.)) %>%\n  arrange(desc(Avg_Rain)) %>%\n \n  ggplot(aes(x = reorder(Station, -Avg_Rain), y = Avg_Rain)) +\n  geom_col(fill = \"lightblue\") +\n  labs(title = \"Rainfall differences at different sites\", x = \"Station\", y = \"Avg Daily Rainfall (mm)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## 3.6 Daily Rainfall Time Chart (Overall Trend)\n\nThis can help us see if there is a clear trend or extreme value\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>%\n  group_by(Date) %>%\n  summarise(Daily_Rainfall_Sum = sum(Daily.Rainfall.Total..mm.)) %>%\n  ggplot(aes(x = Date, y = Daily_Rainfall_Sum)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Daily Rainfall over Time\", y = \"Total Daily Rainfall (mm)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## 3.7 Explore extreme rainfall events\n\nWe can check the distribution of days with rainfall greater than 100mm.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextreme_rain_years <- weather_active %>%\n  filter(Daily.Rainfall.Total..mm. > 100) %>%\n  count(Year)\n\nggplot(extreme_rain_years, aes(x = Year, y = n)) +\n  geom_col(fill = \"pink\") +\n  labs(title = \"Extreme Rainfall Days (>100mm)\", y = \"Number of Days\") +\n  scale_x_continuous(breaks = seq(min(extreme_rain_years$Year), max(extreme_rain_years$Year), by = 1)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## 3.8 Top 10 Station with Highest Extreme Rainfall Rate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Proportion of Extreme Rain Days\nweather_active %>%\n  mutate(ExtremeRain = Daily.Rainfall.Total..mm. > 100) %>%\n  group_by(Station) %>%\n  summarise(ExtremeRate = mean(ExtremeRain)) %>%\n  arrange(desc(ExtremeRate)) %>%\n  head(10) %>%\n  ggplot(aes(x = reorder(Station, -ExtremeRate), y = ExtremeRate)) +\n  geom_col(fill = \"pink\") +\n  labs(title = \"Top 10 Stations with Highest Extreme Rainfall Rate\", y = \"Extreme Rainfall Rate\") +\n  theme_minimal() + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\nWe conducted EDA to uncover key temporal and spatial rainfall trends in Singapore. Monthly and yearly rainfall summaries were visualized to observe seasonality and long-term changes. Station-wise comparisons revealed spatial heterogeneity, while time series plots allowed us to identify potential anomalies and extreme rainfall patterns.\n\n## 3.9 Spatial Rainfall EDA\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggmap)\nlibrary(ggrepel)\n\nweather_active %>%\n  group_by(Station, Latitude, Longitude) %>%\n  summarise(Avg_Rain = mean(Daily.Rainfall.Total..mm.)) %>%\n  ggplot(aes(x = Longitude, y = Latitude, color = Avg_Rain)) +\n  geom_point(size = 3) +\n  scale_color_viridis_c() +\n  labs(title = \"Average Daily Rainfall by Station Location\", color = \"Avg Rainfall (mm)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## 3.10 Time series Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time Series Plot\nlibrary(forecast)\nlibrary(tsibble)\nlibrary(lubridate)\n\nrain_ts <- weather_active %>%\n  group_by(Date) %>%\n  summarise(Total_Rain = sum(Daily.Rainfall.Total..mm., na.rm = TRUE)) %>%\n  ts(start = c(2018, 1), frequency = 365)\n\nautoplot(rain_ts) +\n  labs(title = \"Total Daily Rainfall Over Time\", y = \"Rainfall (mm)\")\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## 3.11 Monthly Rainfall by Monsoon Season\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active %>%\n  group_by(Season, Month) %>%\n  summarise(Avg_Rain = mean(Daily.Rainfall.Total..mm., na.rm = TRUE)) %>%\n  ggplot(aes(x = Month, y = Avg_Rain, fill = Season)) +\n  geom_col(position = \"dodge\") +\n  scale_x_continuous(breaks = 1:12)\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  labs(title = \"Monthly Rainfall by Monsoon Season\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$title\n[1] \"Monthly Rainfall by Monsoon Season\"\n\nattr(,\"class\")\n[1] \"labels\"\n```\n\n\n:::\n:::\n\n\n\nThis grouped bar chart reveals the monthly average daily rainfall categorized by monsoon seasons. We observe that rainfall tends to peak during the **Northeast Monsoon (Decâ€“Jan)** and the **Inter-monsoon periods (Aprâ€“May, Octâ€“Nov)**, while the **Southwest Monsoon (Junâ€“Sep)** exhibits relatively lower rainfall on average. These patterns align well with the seasonal transition periods and help in understanding Singaporeâ€™s bimodal rainfall distribution.\n\n## 3.12 Monthly Average Rainfall Heatmap\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmonthly_avg_rain <- weather_active %>%\n  group_by(Year, Month) %>%\n  summarise(Avg_Rain = mean(Daily.Rainfall.Total..mm., na.rm = TRUE))\n\nggplot(monthly_avg_rain, aes(x = factor(Month), y = factor(Year), fill = Avg_Rain)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = round(Avg_Rain, 1)), size = 3, color = \"black\") +\n  scale_fill_viridis_c(option = \"C\", name = \"Avg Rainfall (mm)\") +\n  labs(\n    title = \"Monthly Average Rainfall Heatmap\",\n    x = \"Month\",\n    y = \"Year\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n# 4. Confirmatory Data Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(weather_active, \"weather_active.csv\", row.names = FALSE)\n```\n:::\n\n\n\n## 4.1 Verify if there are significant differences between different Monsoon seasons\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_result <- aov(Daily.Rainfall.Total..mm. ~ Season, data = weather_active)\nsummary(anova_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df   Sum Sq Mean Sq F value Pr(>F)    \nSeason          3    37148   12383   55.83 <2e-16 ***\nResiduals   64849 14383138     222                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(anova_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Daily.Rainfall.Total..mm. ~ Season, data = weather_active)\n\n$Season\n                                          diff         lwr        upr     p adj\nInter-monsoon I-Northeast Monsoon    0.3643754 -0.06672501  0.7954758 0.1312325\nSouthwest Monsoon-Northeast Monsoon -0.7251748 -1.10644486 -0.3439048 0.0000061\nInter-monsoon II-Northeast Monsoon   1.5037046  1.04110295  1.9663062 0.0000000\nSouthwest Monsoon-Inter-monsoon I   -1.0895502 -1.50796752 -0.6711330 0.0000000\nInter-monsoon II-Inter-monsoon I     1.1393292  0.64566283  1.6329955 0.0000000\nInter-monsoon II-Southwest Monsoon   2.2288794  1.77807379  2.6796850 0.0000000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = weather_active %>% filter(Year == 2021),\n  x = Season,\n  y = Daily.Rainfall.Total..mm.,\n  type = \"p\",\n  pairwise.comparisons = TRUE,\n  pairwise.display = \"s\",\n  output = \"plot\"\n)\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(dplyr)\n\nsummary_stats <- weather_active %>%\n  group_by(Season) %>%\n  summarise(\n    Mean_Rain = round(mean(Daily.Rainfall.Total..mm., na.rm = TRUE), 2),\n    Median_Rain = round(median(Daily.Rainfall.Total..mm., na.rm = TRUE), 2)\n  )\n\n\nggplot(weather_active, aes(x = Season, y = Daily.Rainfall.Total..mm., fill = Season)) +\n  geom_boxplot() +\n  stat_compare_means(method = \"anova\", label.y = 120) +  \n  stat_compare_means(\n    method = \"t.test\",\n    comparisons = list(\n      c(\"Inter-monsoon II\", \"Southwest Monsoon\"),\n      c(\"Southwest Monsoon\", \"Northeast Monsoon\"),\n      c(\"Inter-monsoon II\", \"Inter-monsoon I\")\n    ),\n    label = \"p.format\"\n  ) +\n \n  geom_text(\n    data = summary_stats,\n    aes(x = Season, y = 105, label = paste(\"Mean:\", Mean_Rain)),\n    inherit.aes = FALSE,\n    color = \"black\",\n    size = 3.5\n  ) +\n\n  geom_text(\n    data = summary_stats,\n    aes(x = Season, y = 95, label = paste(\"Median:\", Median_Rain)),\n    inherit.aes = FALSE,\n    color = \"darkblue\",\n    size = 3.5\n  ) +\n  labs(\n    title = \"Comparison of Daily Rainfall across Monsoon Seasons\",\n    y = \"Daily Rainfall (mm)\",\n    x = \"Monsoon Season\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n## 4.2 Does Extreme Rainfall significantly increase in different years\n\nObserve whether extreme rainfall (such as days\\>100mm) has increased in recent years.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextreme_days_by_year <- weather_active %>%\n  filter(Daily.Rainfall.Total..mm. > 100) %>%\n  count(Year)  \n\nmodel_poisson <- glm(n ~ Year, family = \"poisson\", data = extreme_days_by_year)\n\nsummary(model_poisson)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = n ~ Year, family = \"poisson\", data = extreme_days_by_year)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -280.06152   80.61708  -3.474 0.000513 ***\nYear           0.14012    0.03988   3.514 0.000442 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 112.372  on 6  degrees of freedom\nResidual deviance:  99.724  on 5  degrees of freedom\nAIC: 136.28\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(extreme_days_by_year, aes(x = Year, y = n)) +\n  geom_point(size = 3, color = \"darkred\") +\n  geom_smooth(method = \"glm\", method.args = list(family = \"poisson\"),\n              se = TRUE, color = \"steelblue\") +\n  labs(title = \"Poisson Regression: Extreme Rainfall Days by Year\",\n       x = \"Year\", y = \"Extreme Rainfall Days\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\nA Poisson regression was performed to evaluate whether the number of extreme rainfall days (daily rainfall \\> 100mm) has increased over the years.\\\nThe analysis revealed a statistically significant positive association between year and the count of extreme rainfall days (Î² = 0.14, *p* \\< 0.001).\\\nThis suggests that the frequency of extreme rainfall events has been increasing in recent years.\n\n## 4.3 Regional difference analysis (whether the rainfall in the southeast, northwest, and northwest is different)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_active <- weather_active %>%\n  mutate(MainRegion = case_when(\n    Station %in% c(\"Pasir Ris (West)\", \"Pasir Ris Central\", \"Simei\", \"Tanjong Katong\", \"Marine Parade\") ~ \"East\", \n    Station %in% c(\"Punggol\", \"Serangoon\") ~ \"Northeast\",\n    Station %in% c(\"Kranji Reservoir\", \"Mandai\") ~ \"North\",\n    Station %in% c(\"Jurong Pier\", \"Tuas\", \"Bukit Panjang\", \"Choa Chu Kang (Central)\", \"Lim Chu Kang\") ~ \"West\",\n    TRUE ~ \"Central\"\n  ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_mainregion <- aov(Daily.Rainfall.Total..mm. ~ MainRegion, data = weather_active)\nsummary(anova_mainregion)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df   Sum Sq Mean Sq F value Pr(>F)    \nMainRegion      4    20792    5198   23.41 <2e-16 ***\nResiduals   64848 14399494     222                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nTukeyHSD(anova_mainregion)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Daily.Rainfall.Total..mm. ~ MainRegion, data = weather_active)\n\n$MainRegion\n                        diff        lwr        upr     p adj\nEast-Central      -1.0736654 -1.5316381 -0.6156928 0.0000000\nNorth-Central      0.4067185 -0.2045632  1.0180001 0.3647933\nNortheast-Central -1.3204749 -2.0449388 -0.5960109 0.0000066\nWest-Central       0.5729730  0.1125827  1.0333633 0.0061806\nNorth-East         1.4803839  0.7785093  2.1822585 0.0000001\nNortheast-East    -0.2468095 -1.0491876  0.5555687 0.9184639\nWest-East          1.6466384  1.0713803  2.2218965 0.0000000\nNortheast-North   -1.7271933 -2.6259352 -0.8284515 0.0000016\nWest-North         0.1662545 -0.5372000  0.8697090 0.9676690\nWest-Northeast     1.8934478  1.0896873  2.6972084 0.0000000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(weather_active, aes(x = MainRegion, y = Daily.Rainfall.Total..mm., fill = MainRegion)) +\n  geom_boxplot() +\n  stat_compare_means(method = \"anova\", label.y = 120) +\n  labs(title = \"Daily Rainfall by Region\", y = \"Rainfall (mm)\", x = \"Region\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n## 4.4 Linear Regression (Rainfall\\~Month)\n\nObserve the overall trend of month vs rainfall\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_month <- lm(Daily.Rainfall.Total..mm. ~ Month, data = weather_active)\nsummary(lm_month)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Daily.Rainfall.Total..mm. ~ Month, data = weather_active)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n -7.942  -7.237  -6.473   0.045 239.822 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  6.25013    0.12514  49.946   <2e-16 ***\nMonth        0.14095    0.01698   8.301   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.9 on 64851 degrees of freedom\nMultiple R-squared:  0.001061,\tAdjusted R-squared:  0.001046 \nF-statistic:  68.9 on 1 and 64851 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(weather_active, aes(x = Month, y = Daily.Rainfall.Total..mm.)) +\n  geom_jitter(alpha = 0.2, color = \"lightblue\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"darkblue\") +\n  labs(title = \"Linear Trend of Rainfall by Month\",\n       x = \"Month\", y = \"Daily Rainfall (mm)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_CDA_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\nClick here you can see the shiny app original version\n\n<https://wangxingyun.shinyapps.io/final_project/>\n",
    "supporting": [
      "EDA_CDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}